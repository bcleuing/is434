<!DOCTYPE html>
<html>
<head>
    <title>IS434 - Vaniday Fans Analysis (Charts Visualization)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css">
    <link rel="stylesheet" href="resources/css/style.css" />
</head>
<body>

    <div class="container">
        <div class="row">
            <div class="col s12" id="pagesFanInfoTable" hidden>
                <h5>Fan Statistics (Table)</h5>
            </div>
        </div>

        <div class="row">
            <div class="col s12" id="pagesFanInfoChart" hidden>
                <h5>Fan Statistics (Charts)</h5>
            </div>
        </div>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="resources/js/vaniday-fans-analysis.js"></script>
    <script>
        $(function() {
            $.ajax({
                url: "resources/data/lifetime-likes-by-gender-and-age.csv",
                type: "GET",
                dataType: "text",
                success: function(data) {
                    processData(data);
                }
            })
        });

        function processData(allText) {
            var allTextLines = allText.split(/\r\n|\n/);
            var headers = allTextLines[0].split(',');
            headers.shift(); // remove the date column
            var headersLength = headers.length;

            var jsonData = {};
            for (var i = 0; i < headersLength; i++) {
                // initialize the JSON object
                jsonData[headers[i]] = 0;
            }

            var lines = [];
            for (i = 1; i < allTextLines.length; i++) {
                var data = allTextLines[i].split(',');
                data.shift(); // remove the date record
                if (data.length == headersLength) {
                    for (var j = 0; j < headersLength; j++) {
                        jsonData[headers[j]] = data[j];
                    }
                    lines.push(jsonData);
                }
            }
            getPageFanInfo(lines);
        }
    </script>

</body>
</html>
